<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, shrink-to-fit=no">
    <title>Document</title>
    <link rel="stylesheet" href="pagination.css">
<body>

<div></div>
<div></div>
<div></div>
<div></div>

<script>
    class Pagination {
        constructor(container, options) {
            const _defaultOptions = {
                size: 10,
                total: 1,
                current: 1,

                href: '#',

                firstText: '처음',
                lastText: '마지막',
                prevText: '이전',
                nextText: '다음',

                paginationClass: 'pagination',
                itemClass: 'pagination__item',
                anchorClass: 'pagination__anchor',
                currentClass: 'pagination__item--current',
                disabledClass: 'pagination__item--disabled',
                textClass: 'pagination__page',
                firstClass: 'pagination__item--first',
                lastClass: 'pagination__item--last',
                prevClass: 'pagination__item--prev',
                nextClass: 'pagination__item--next'
            };

            Object.assign(this.options = {}, _defaultOptions, options);

            if (this.isValid(container)) {
                this.render();
            }
        }

        isValid(container) {
            if (!container) {
                console.log('container 가 없습니다.');
                return false;
            }

            this.container = container;

            return true;
        }

        getPage () {
            const {size, total, current} = this.options;

            const start = ~~((current - 1) / size) * size + 1;
            const end = Math.min((start + size), (total + 1));

            const first = current !== 1 ? 1 : 'disabled';
            const last = current !== total ? total : 'disabled';

            const prev = start - size > 1 ? start - size : 'disabled';
            const next = start + size < total ? start + size : 'disabled';

            Object.assign(this.options, {start, end, prev, next, first, last});
        }

        buildControl(type) {
            const text = this.buildText(type);
            const anchor = this.buildAnchor(this.options[type], this.options[type], text);

            return this.buildItem(anchor, type, this.options[type]);
        }

        buildItems() {
            const current = this.options.current;
            let result = '';

            for (let i = this.options.start; i < this.options.end; i++) {
                const isCurrent = i !== current ? '' : 'current';
                const text = this.buildText(i);
                const anchor = this.buildAnchor(i, isCurrent, text);

                result += this.buildItem(anchor, isCurrent);
            }

            return result;
        }

        buildItem(text, ...typeStatus) {
            const classList =
                [this.options.itemClass]
                    .concat(typeStatus.map(key => this.options[key + 'Class']))
                    .filter(value => !!value)
                    .join(' ');

            return `<li class="${classList}">${text}</li>`;
        }

        buildAnchor(page, status, text) {
            switch (status) {
                case 'current':
                    return `<strong class="${this.options.anchorClass}">${text}</strong>`;
                case 'disabled':
                    return `<span class="${this.options.anchorClass}">${text}</span>`;
                default:
                    const href = this.options.href ? `${this.options.href}${page}` : '#';

                    return `<a href="${href}" class="${this.options.anchorClass}">${text}</a>`;
            }
        }

        buildText(page) {
            return `<span class="${this.options.textClass}">
                        ${typeof page === 'number' ? page : this.options[page + 'Text']}
                    </span>`;
        }

        render() {
            this.getPage();

            const tag = [
                    `<ul class="${this.options.paginationClass}">`,
                    this.buildControl('first'),
                    this.buildControl('prev'),
                    this.buildItems(),
                    this.buildControl('next'),
                    this.buildControl('last'),
                    '</ul>'
                ].join('');

            this.container.innerHTML = tag;
        }
    }

    [...document.querySelectorAll('div')].forEach((div, idx) => {
        new Pagination(div, {
            current: idx * 5 + 2,
            total: 19,
            href: '/ko/anchor.html?a='
        });
    });

</script>

</body>
</html>