<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, shrink-to-fit=no">
    <title>Document</title>
    <link rel="stylesheet" href="pagination.css">
<body>

<div></div>
<div></div>
<div></div>
<div></div>

<script>
    class Pagination {
        constructor(container, options) {
            const _defaultOptions = {
                size: 10,
                total: 1,
                current: 1,
                first: 1,
                last: 1,
                prev: 1,
                next: 1,
                start: 1,
                end: 1,

                href: '#',

                firstText: '처음',
                lastText: '마지막',
                prevText: '이전',
                nextText: '다음',

                paginationClass: 'pagination',
                itemClass: 'pagination__item',
                anchorClass: 'pagination__anchor',
                currentClass: 'pagination__item--current',
                disabledClass: 'pagination__item--disabled',
                textClass: 'pagination__page',
                firstClass: 'pagination__item--first',
                lastClass: 'pagination__item--last',
                prevClass: 'pagination__item--prev',
                nextClass: 'pagination__item--next'
            };

            Object.assign(this.options = {}, _defaultOptions, options);

            this.container = container;
        }

        isValid() {

        }

        getRange() {
            const start = ~~((this.options.current - 1) / this.options.size) * this.options.size + 1;
            const end = Math.min((start + this.options.size), (this.options.total + 1));

            return {
                start,
                end
            };
        }

        getPage () {
            const size = this.options.size;
            const total = this.options.total;

            const start = ~~((this.options.current - 1) / size) * size + 1;
            const end = Math.min((start + size), (total + 1));

            const prev = start - size > 1 ? start - size : 'disabled';
            const next = start + size < total ? start + size : 'disabled';

            const first = this.options.current !== 1 ? 1 : 'disabled';
            const last = this.options.current !== total ? total : 'disabled';

            Object.assign(this.options, {start, end, prev, next, first, last});
        }

        makeHref(page) {
            return this.options.href ? `${this.options.href}${page}` : '#';
        }

        buildControl(type) {
            const text = this.buildText(type);
            const anchor = this.buildAnchor(this.options[type], this.options[type], text);
            return this.buildItem(anchor, type, this.options[type]);
        }

        buildItem(text, ...typeStatus) {
            const classList =
                [this.options.itemClass]
                    .concat(typeStatus.map(key => this.options[key + 'Class']))
                    .filter(value => !!value)
                    .join(' ');

            return `<li class="${classList}">${text}</li>`;
        }

        buildAnchor(page, status, text) {
            switch (status) {
                case 'current':
                    return `<strong class="${this.options.anchorClass}">${text}</strong>`;
                case 'disabled':
                    return `<span class="${this.options.anchorClass}">${text}</span>`;
                default:
                    return `<a href="${this.options.href}${page}" class="${this.options.anchorClass}">${text}</a>`;
            }
        }

        buildText(page) {
            return `<span class="${this.options.textClass}">
                        ${typeof page === 'number' ? page : this.options[page + 'Text']}
                    </span>`;
        }

        render() {
        let tag = '<ul class="pagination">';

            this.getPage();


            tag += this.buildControl('first');
            tag += this.buildControl('prev');
            tag += this.buildControl('next');
            tag += this.buildControl('last');

            for (let i = this.options.start; i < this.options.end; i++) {
                const isCurrent = i !== this.options.current ? '' : 'current';
                const text = this.buildText(i);
                const anchor = this.buildAnchor(i, isCurrent, text);

                tag += this.buildItem(anchor, isCurrent);
            }

            tag += '</ul>';

            this.container.innerHTML = tag;
        }
    }


    // for (let i = 0; i < 13; i++) {
    //     new Pagination('', {
    //         current: i + 1
    //     }).render();
    // }

    [...document.querySelectorAll('div')].forEach((div, idx) => {
        new Pagination(div, {
            current: idx * 5 + 2,
            total: 19,
            href: '/ko/anchor.html?a='
        }).render();
    });

    //const pagination = new Pagination(document.querySelector('div'));

    //pagination.render();
</script>

</body>
</html>